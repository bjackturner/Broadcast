!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.16 (master) -  9 Oct 2020 17:47
!
!  Differentiation of coeffs_5p_dz in forward (tangent) mode (with options with!SliceDeadControl with!SliceDeadInstrs with!Static
!Taping):
!   variations   of useful results: dz_out
!   with respect to varying inputs: w
!   RW status of diff variables: w:in dz_out:out
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
SUBROUTINE COEFFS_5P_DZ_D(dz_out, dz_outd, w, wd0, wd, x0, y0, nx, ny, &
& xc, yc, vol, volf, gh, cp, cv, prandtl, gam, rgaz, cs, muref, tref, &
& s_suth, im, jm)
  IMPLICIT NONE
!
! variables for dimension -----------------------------------------
  INTEGER :: im, jm, gh
! required arguments ----------------------------------------------
! thermo
  REAL*8, INTENT(IN) :: cp, cv, prandtl, gam, rgaz
! viscosity
  REAL*8, INTENT(IN) :: cs, muref, tref, s_suth
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1), INTENT(IN) :: x0
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1), INTENT(IN) :: y0
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1, 2), INTENT(IN) :: nx
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1, 2), INTENT(IN) :: ny
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh), INTENT(IN) :: xc
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh), INTENT(IN) :: yc
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh), INTENT(IN) :: vol
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 2), INTENT(IN) :: volf
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5), INTENT(IN) :: w
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5), INTENT(IN) :: wd0
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5), INTENT(IN) :: wd
! Returned objects ------------------------------------------------
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5), INTENT(INOUT) :: dz_out
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5), INTENT(INOUT) :: dz_outd
! Non-required arguments -------------------------------------------
  REAL*8, DIMENSION(im, jm, 5) :: func0
  REAL*8, DIMENSION(im, jm, 5) :: func0d
  REAL*8, DIMENSION(im, jm, 5) :: func0dd
  REAL*8, DIMENSION(im, jm, 5) :: func1
  REAL*8, DIMENSION(im, jm, 5) :: func1d
  REAL*8, DIMENSION(im, jm, 5) :: func1dd
  REAL*8, DIMENSION(im, jm, 5) :: func2
  REAL*8, DIMENSION(im, jm, 5) :: func2d
  REAL*8, DIMENSION(im, jm, 5) :: func2dd
  REAL*8, DIMENSION(im, jm, 5) :: func3
  REAL*8, DIMENSION(im, jm, 5) :: func3d
  REAL*8, DIMENSION(im, jm, 5) :: func3dd
  REAL*8, DIMENSION(im, jm, 5) :: func4
  REAL*8, DIMENSION(im, jm, 5) :: func4d
  REAL*8, DIMENSION(im, jm, 5) :: func4dd
  REAL*8, DIMENSION(im, jm, 5) :: func5
  REAL*8, DIMENSION(im, jm, 5) :: func5d
  REAL*8, DIMENSION(im, jm, 5) :: func5dd
  REAL*8, DIMENSION(im, jm, 5) :: func6
  REAL*8, DIMENSION(im, jm, 5) :: func6d
  REAL*8, DIMENSION(im, jm, 5) :: func6dd
  REAL*8, DIMENSION(im, jm, 5) :: func7
  REAL*8, DIMENSION(im, jm, 5) :: func7d
  REAL*8, DIMENSION(im, jm, 5) :: func7dd
  REAL*8, DIMENSION(im, jm, 5) :: func8
  REAL*8, DIMENSION(im, jm, 5) :: func8d
  REAL*8, DIMENSION(im, jm, 5) :: func8dd
  REAL*8, DIMENSION(im, jm, 5) :: func9
  REAL*8, DIMENSION(im, jm, 5) :: func9d
  REAL*8, DIMENSION(im, jm, 5) :: func9dd
  REAL*8, DIMENSION(im, jm, 5) :: func10
  REAL*8, DIMENSION(im, jm, 5) :: func10d
  REAL*8, DIMENSION(im, jm, 5) :: func10dd
  REAL*8, DIMENSION(im, jm, 5) :: func11
  REAL*8, DIMENSION(im, jm, 5) :: func11d
  REAL*8, DIMENSION(im, jm, 5) :: func11dd
  REAL*8, DIMENSION(im, jm, 5) :: func12
  REAL*8, DIMENSION(im, jm, 5) :: func12d
  REAL*8, DIMENSION(im, jm, 5) :: func12dd
  REAL*8, DIMENSION(im, jm, 5) :: func13
  REAL*8, DIMENSION(im, jm, 5) :: func13d
  REAL*8, DIMENSION(im, jm, 5) :: func13dd
  REAL*8, DIMENSION(im, jm, 5) :: func14
  REAL*8, DIMENSION(im, jm, 5) :: func14d
  REAL*8, DIMENSION(im, jm, 5) :: func14dd
  REAL*8, DIMENSION(im, jm, 5) :: func15
  REAL*8, DIMENSION(im, jm, 5) :: func15d
  REAL*8, DIMENSION(im, jm, 5) :: func15dd
  REAL*8, DIMENSION(im, jm, 5, 16) :: coeffs
  REAL*8, DIMENSION(im, jm, 5, 16) :: coeffsd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5) :: f, g
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velx
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velxd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: vely
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velyd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velz
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velzd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: tloc
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: tlocd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: p
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: mu
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: mud
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 2) :: gradu, gradv, gradw, &
& gradmu
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 2) :: gradud, gradvd, gradwd&
& , gradmud
  INTEGER :: i, j, h
  REAL*8 :: nx_n, nx_s, nx_e, nx_o, volm1, ux, vx, wx, tx
  REAL*8 :: ny_n, ny_s, ny_e, ny_o, uy, vy, wy, ty
  REAL*8 :: val_n, val_s, val_e, val_o
  REAL*8 :: fxro1, fxro2, fxrou1, fxrou2, fxrov1, fxrov2, fxrow1, fxrow2&
& , fxroe1, fxroe2
  REAL*8 :: dissro1, dissro2, dissrou1, dissrou2, dissrov1, dissrov2, &
& dissrow1, dissrow2, dissroe1, dissroe2
  REAL*8 :: fvro1, fvro2, fvrou1, fvrou2, fvrov1, fvrov2, fvrow1, fvrow2&
& , fvroe1, fvroe2
  REAL*8 :: gvro1, gvro2, gvrou1, gvrou2, gvrov1, gvrov2, gvrow1, gvrow2&
& , gvroe1, gvroe2
  REAL*8 :: cpprandtl, mmu, lambda, uu, vv, ww, ro, rom1, htot, eloc, ec
  REAL*8 :: rod, rom1d, elocd, ecd
  REAL*8 :: predro1, predrou1, predrov1, predrow1, predroe1, eps2, eps4
  REAL*8 :: predro2, predrou2, predrov2, predrow2, predroe2, rspec
  REAL*8 :: divu2, vort2, dx, dy, dxm1, dym1, dxm2, dym2
  REAL*8 :: gui, gvi, gwi, gmui
  REAL*8 :: guid, gvid, gwid, gmuid
  REAL*8 :: guj, gvj, gwj, gmuj
  REAL*8 :: gujd, gvjd, gwjd, gmujd
  REAL*8 :: rhom, rhomr, rhoml, rhom1l, c2l, c2r, rr, r, u, ur, ul, vr, &
& vl, wr, wl, c2x, nx2, ny2
  REAL*8 :: ab, sq, ducros1, ducros2, k_sensor1, k_sensor2
  REAL*8 :: b1, b2, b3, b4, b5, c1, c2, c3, c4, c5, wiggle, denom, betas
  REAL*8 :: nxloc, nyloc, sn, invsn, sc1, sc2
  REAL*8 :: d1, d2
  REAL*8 :: c3d0, c3d1
  REAL*8 :: pw, ct0, ct1, ct2, cvm1
  REAL*8 :: coef, omrr, test, diffro, diffrou, diffrov, diffrow, diffroe&
& , v
  REAL*8 :: half, one, zero, two, twothird, fourth, twelfth
  REAL*8 :: twentyfourth, ccross
  INTRINSIC SQRT
  REAL*8 :: result1
  REAL*8 :: result1d
  REAL*8 :: temp
! -----------------------------------------------------------------
!
  half = 0.5d0
  one = 1.d0
  zero = 0.d0
  twothird = 2.d0/3.d0
  cvm1 = one/cv
! Coef for grad o4
  denom = 1.d0/12.d0
  b1 = 8.d0*denom
  b2 = -denom
! Primitives
! for Sutherland
  result1 = SQRT(tref)
  betas = muref*(tref+cs)/(result1*tref)
  velxd = 0.0_8
  velyd = 0.0_8
  velzd = 0.0_8
  tlocd = 0.0_8
  mud = 0.0_8
  DO j=1-gh,jm+gh
!DIR$ IVDEP
    DO i=1-gh,im+gh
      rod = wd0(i, j, 1)
      ro = w(i, j, 1)
      rom1d = -(one*rod/ro**2)
      rom1 = one/ro
      velxd(i, j) = rom1*wd0(i, j, 2) + w(i, j, 2)*rom1d
      velx(i, j) = w(i, j, 2)*rom1
      velyd(i, j) = rom1*wd0(i, j, 3) + w(i, j, 3)*rom1d
      vely(i, j) = w(i, j, 3)*rom1
      velzd(i, j) = rom1*wd0(i, j, 4) + w(i, j, 4)*rom1d
      velz(i, j) = w(i, j, 4)*rom1
!
      ecd = half*(2*velx(i, j)*velxd(i, j)+2*vely(i, j)*velyd(i, j)+2*&
&       velz(i, j)*velzd(i, j))
      ec = half*(velx(i, j)*velx(i, j)+vely(i, j)*vely(i, j)+velz(i, j)*&
&       velz(i, j))
! ec  = HALF*( velx(i,j)*velx(i,j) &
!            + vely(i,j)*vely(i,j))
!
      temp = w(i, j, 5) - ec*ro
      elocd = rom1*(wd0(i, j, 5)-ro*ecd-ec*rod) + temp*rom1d
      eloc = temp*rom1
!
      tlocd(i, j) = cvm1*elocd
      tloc(i, j) = eloc*cvm1
!
!  p(i,j)  = ro*rgaz*tloc(i,j)
!h(i,j,1)  = w(i,j,4)
!h(i,j,2)  = w(i,j,4) * velx(i,j)
!h(i,j,3)  = w(i,j,4) * vely(i,j)
!h(i,j,4)  = w(i,j,4) * velz(i,j) + p(i,j)
!h(i,j,5)  = w(i,j,4) * htot
      temp = SQRT(tloc(i, j))
      IF (tloc(i, j) .EQ. 0.0) THEN
        result1d = 0.0_8
      ELSE
        result1d = tlocd(i, j)/(2.0*temp)
      END IF
      result1 = temp
      temp = result1*tloc(i, j)/(s_suth+tloc(i, j))
      mud(i, j) = betas*(tloc(i, j)*result1d+(result1-temp)*tlocd(i, j))&
&       /(s_suth+tloc(i, j))
      mu(i, j) = betas*temp
    END DO
  END DO
  gradud = 0.0_8
  gradvd = 0.0_8
  gradwd = 0.0_8
  gradmud = 0.0_8
! Work on interior domain minus one cell
  DO j=1,jm
!DIR$ IVDEP
    DO i=1,im
!idir
      guid = b1*(velxd(i+1, j)-velxd(i-1, j)) + b2*(velxd(i+2, j)-velxd(&
&       i-2, j))
      gui = b1*(velx(i+1, j)-velx(i-1, j)) + b2*(velx(i+2, j)-velx(i-2, &
&       j))
      gvid = b1*(velyd(i+1, j)-velyd(i-1, j)) + b2*(velyd(i+2, j)-velyd(&
&       i-2, j))
      gvi = b1*(vely(i+1, j)-vely(i-1, j)) + b2*(vely(i+2, j)-vely(i-2, &
&       j))
      gwid = b1*(velzd(i+1, j)-velzd(i-1, j)) + b2*(velzd(i+2, j)-velzd(&
&       i-2, j))
      gwi = b1*(velz(i+1, j)-velz(i-1, j)) + b2*(velz(i+2, j)-velz(i-2, &
&       j))
      gmuid = b1*(mud(i+1, j)-mud(i-1, j)) + b2*(mud(i+2, j)-mud(i-2, j)&
&       )
      gmui = b1*(mu(i+1, j)-mu(i-1, j)) + b2*(mu(i+2, j)-mu(i-2, j))
!jdir
      gujd = b1*(velxd(i, j+1)-velxd(i, j-1)) + b2*(velxd(i, j+2)-velxd(&
&       i, j-2))
      guj = b1*(velx(i, j+1)-velx(i, j-1)) + b2*(velx(i, j+2)-velx(i, j-&
&       2))
      gvjd = b1*(velyd(i, j+1)-velyd(i, j-1)) + b2*(velyd(i, j+2)-velyd(&
&       i, j-2))
      gvj = b1*(vely(i, j+1)-vely(i, j-1)) + b2*(vely(i, j+2)-vely(i, j-&
&       2))
      gwjd = b1*(velzd(i, j+1)-velzd(i, j-1)) + b2*(velzd(i, j+2)-velzd(&
&       i, j-2))
      gwj = b1*(velz(i, j+1)-velz(i, j-1)) + b2*(velz(i, j+2)-velz(i, j-&
&       2))
      gmujd = b1*(mud(i, j+1)-mud(i, j-1)) + b2*(mud(i, j+2)-mud(i, j-2)&
&       )
      gmuj = b1*(mu(i, j+1)-mu(i, j-1)) + b2*(mu(i, j+2)-mu(i, j-2))
      volm1 = one/vol(i, j)
      dxm1 = half*(nx(i, j, 1)+nx(i+1, j, 1))*volm1
      dxm2 = half*(nx(i, j, 2)+nx(i, j+1, 2))*volm1
      dym1 = half*(ny(i, j, 1)+ny(i+1, j, 1))*volm1
      dym2 = half*(ny(i, j, 2)+ny(i, j+1, 2))*volm1
      gradud(i, j, 1) = dxm1*guid + dxm2*gujd
      gradu(i, j, 1) = dxm1*gui + dxm2*guj
      gradvd(i, j, 1) = dxm1*gvid + dxm2*gvjd
      gradv(i, j, 1) = dxm1*gvi + dxm2*gvj
      gradwd(i, j, 1) = dxm1*gwid + dxm2*gwjd
      gradw(i, j, 1) = dxm1*gwi + dxm2*gwj
      gradmud(i, j, 1) = dxm1*gmuid + dxm2*gmujd
      gradmu(i, j, 1) = dxm1*gmui + dxm2*gmuj
      gradud(i, j, 2) = dym1*guid + dym2*gujd
      gradu(i, j, 2) = dym1*gui + dym2*guj
      gradvd(i, j, 2) = dym1*gvid + dym2*gvjd
      gradv(i, j, 2) = dym1*gvi + dym2*gvj
      gradwd(i, j, 2) = dym1*gwid + dym2*gwjd
      gradw(i, j, 2) = dym1*gwi + dym2*gwj
      gradmud(i, j, 2) = dym1*gmuid + dym2*gmujd
      gradmu(i, j, 2) = dym1*gmui + dym2*gmuj
    END DO
  END DO
  coeffsd = 0.0_8
  DO j=1,jm
!DIR$ IVDEP
    DO i=1,im
!
      coeffsd(i, j, 1, 1) = 0.0_8
      coeffs(i, j, 1, 1) = one
      coeffsd(i, j, 2, 1) = 0.0_8
      coeffs(i, j, 2, 1) = one
      coeffsd(i, j, 3, 1) = 0.0_8
      coeffs(i, j, 3, 1) = one
      coeffsd(i, j, 4, 1) = 0.0_8
      coeffs(i, j, 4, 1) = one
      coeffsd(i, j, 5, 1) = 0.0_8
      coeffs(i, j, 5, 1) = one
      coeffsd(i, j, 1, 2) = 0.0_8
      coeffs(i, j, 1, 2) = zero
!ZERO !TWOTHIRD * gradmu(i,j,1)
      coeffsd(i, j, 2, 2) = twothird*gradmud(i, j, 1)
      coeffs(i, j, 2, 2) = twothird*gradmu(i, j, 1)
!ZERO !TWOTHIRD * gradmu(i,j,2)
      coeffsd(i, j, 3, 2) = twothird*gradmud(i, j, 2)
      coeffs(i, j, 3, 2) = twothird*gradmu(i, j, 2)
!ZERO !- gradmu(i,j,1)
      coeffsd(i, j, 4, 2) = -gradmud(i, j, 1)
      coeffs(i, j, 4, 2) = -gradmu(i, j, 1)
!TWOTHIRD*mu(i,j)*gradu(i,j,1) !TWOTHIRD * ( gradmu(i,j,1) * velx(i,j) + mu(i,j) * gradu(i,j,1) )
      coeffsd(i, j, 5, 2) = twothird*(velx(i, j)*gradmud(i, j, 1)+gradmu&
&       (i, j, 1)*velxd(i, j)+gradu(i, j, 1)*mud(i, j)+mu(i, j)*gradud(i&
&       , j, 1))
      coeffs(i, j, 5, 2) = twothird*(gradmu(i, j, 1)*velx(i, j)+mu(i, j)&
&       *gradu(i, j, 1))
      coeffsd(i, j, 1, 3) = 0.0_8
      coeffs(i, j, 1, 3) = zero
      coeffsd(i, j, 2, 3) = twothird*mud(i, j)
      coeffs(i, j, 2, 3) = twothird*mu(i, j)
      coeffsd(i, j, 3, 3) = twothird*mud(i, j)
      coeffs(i, j, 3, 3) = twothird*mu(i, j)
!ZERO !- gradmu(i,j,2)
      coeffsd(i, j, 4, 3) = -gradmud(i, j, 2)
      coeffs(i, j, 4, 3) = -gradmu(i, j, 2)
      coeffsd(i, j, 5, 3) = twothird*(velx(i, j)*mud(i, j)+mu(i, j)*&
&       velxd(i, j))
      coeffs(i, j, 5, 3) = twothird*mu(i, j)*velx(i, j)
      coeffsd(i, j, 1, 4) = 0.0_8
      coeffs(i, j, 1, 4) = zero
      coeffsd(i, j, 2, 4) = 0.0_8
      coeffs(i, j, 2, 4) = zero
      coeffsd(i, j, 3, 4) = 0.0_8
      coeffs(i, j, 3, 4) = zero
      coeffsd(i, j, 4, 4) = -mud(i, j)
      coeffs(i, j, 4, 4) = -mu(i, j)
!-mu(i,j)*gradw(i,j,1) !- ( gradmu(i,j,1) * velz(i,j) + mu(i,j) * gradw(i,j,1) )
      coeffsd(i, j, 5, 4) = -(velz(i, j)*gradmud(i, j, 1)) - gradmu(i, j&
&       , 1)*velzd(i, j) - gradw(i, j, 1)*mud(i, j) - mu(i, j)*gradwd(i&
&       , j, 1)
      coeffs(i, j, 5, 4) = -(gradmu(i, j, 1)*velz(i, j)+mu(i, j)*gradw(i&
&       , j, 1))
      coeffsd(i, j, 1, 5) = 0.0_8
      coeffs(i, j, 1, 5) = zero
      coeffsd(i, j, 2, 5) = 0.0_8
      coeffs(i, j, 2, 5) = zero
      coeffsd(i, j, 3, 5) = 0.0_8
      coeffs(i, j, 3, 5) = zero
      coeffsd(i, j, 4, 5) = 0.0_8
      coeffs(i, j, 4, 5) = zero
      coeffsd(i, j, 5, 5) = -(velz(i, j)*mud(i, j)+mu(i, j)*velzd(i, j))
      coeffs(i, j, 5, 5) = -(mu(i, j)*velz(i, j))
      coeffsd(i, j, 1, 6) = 0.0_8
      coeffs(i, j, 1, 6) = zero
      coeffsd(i, j, 2, 6) = 0.0_8
      coeffs(i, j, 2, 6) = zero
      coeffsd(i, j, 3, 6) = 0.0_8
      coeffs(i, j, 3, 6) = zero
      coeffsd(i, j, 4, 6) = 0.0_8
      coeffs(i, j, 4, 6) = zero
!TWOTHIRD*mu(i,j)*gradv(i,j,2) !TWOTHIRD * ( gradmu(i,j,2) * vely(i,j) + mu(i,j) * gradv(i,j,2) )
      coeffsd(i, j, 5, 6) = twothird*(vely(i, j)*gradmud(i, j, 2)+gradmu&
&       (i, j, 2)*velyd(i, j)+gradv(i, j, 2)*mud(i, j)+mu(i, j)*gradvd(i&
&       , j, 2))
      coeffs(i, j, 5, 6) = twothird*(gradmu(i, j, 2)*vely(i, j)+mu(i, j)&
&       *gradv(i, j, 2))
      coeffsd(i, j, 1, 7) = 0.0_8
      coeffs(i, j, 1, 7) = zero
      coeffsd(i, j, 2, 7) = 0.0_8
      coeffs(i, j, 2, 7) = zero
      coeffsd(i, j, 3, 7) = 0.0_8
      coeffs(i, j, 3, 7) = zero
      coeffsd(i, j, 4, 7) = 0.0_8
      coeffs(i, j, 4, 7) = zero
      coeffsd(i, j, 5, 7) = twothird*(vely(i, j)*mud(i, j)+mu(i, j)*&
&       velyd(i, j))
      coeffs(i, j, 5, 7) = twothird*mu(i, j)*vely(i, j)
      coeffsd(i, j, 1, 8) = 0.0_8
      coeffs(i, j, 1, 8) = zero
      coeffsd(i, j, 2, 8) = 0.0_8
      coeffs(i, j, 2, 8) = zero
      coeffsd(i, j, 3, 8) = 0.0_8
      coeffs(i, j, 3, 8) = zero
      coeffsd(i, j, 4, 8) = 0.0_8
      coeffs(i, j, 4, 8) = zero
!-mu(i,j)*gradw(i,j,2) !- ( gradmu(i,j,2) * velz(i,j) + mu(i,j) * gradw(i,j,2) )
      coeffsd(i, j, 5, 8) = -(velz(i, j)*gradmud(i, j, 2)) - gradmu(i, j&
&       , 2)*velzd(i, j) - gradw(i, j, 2)*mud(i, j) - mu(i, j)*gradwd(i&
&       , j, 2)
      coeffs(i, j, 5, 8) = -(gradmu(i, j, 2)*velz(i, j)+mu(i, j)*gradw(i&
&       , j, 2))
      coeffsd(i, j, 1, 9) = 0.0_8
      coeffs(i, j, 1, 9) = zero
      coeffsd(i, j, 2, 9) = 0.0_8
      coeffs(i, j, 2, 9) = zero
      coeffsd(i, j, 3, 9) = 0.0_8
      coeffs(i, j, 3, 9) = zero
      coeffsd(i, j, 4, 9) = 0.0_8
      coeffs(i, j, 4, 9) = zero
      coeffsd(i, j, 5, 9) = -(velz(i, j)*mud(i, j)+mu(i, j)*velzd(i, j))
      coeffs(i, j, 5, 9) = -(mu(i, j)*velz(i, j))
      coeffsd(i, j, 1, 10) = 0.0_8
      coeffs(i, j, 1, 10) = zero
      coeffsd(i, j, 2, 10) = 0.0_8
      coeffs(i, j, 2, 10) = zero
      coeffsd(i, j, 3, 10) = 0.0_8
      coeffs(i, j, 3, 10) = zero
      coeffsd(i, j, 4, 10) = 0.0_8
      coeffs(i, j, 4, 10) = zero
      coeffsd(i, j, 5, 10) = -(gradw(i, j, 1)*mud(i, j)+mu(i, j)*gradwd(&
&       i, j, 1))
      coeffs(i, j, 5, 10) = -(mu(i, j)*gradw(i, j, 1))
      coeffsd(i, j, 1, 11) = 0.0_8
      coeffs(i, j, 1, 11) = zero
      coeffsd(i, j, 2, 11) = 0.0_8
      coeffs(i, j, 2, 11) = zero
      coeffsd(i, j, 3, 11) = 0.0_8
      coeffs(i, j, 3, 11) = zero
      coeffsd(i, j, 4, 11) = 0.0_8
      coeffs(i, j, 4, 11) = zero
      coeffsd(i, j, 5, 11) = -velxd(i, j)
      coeffs(i, j, 5, 11) = -velx(i, j)
      coeffsd(i, j, 1, 12) = 0.0_8
      coeffs(i, j, 1, 12) = zero
      coeffsd(i, j, 2, 12) = 0.0_8
      coeffs(i, j, 2, 12) = zero
      coeffsd(i, j, 3, 12) = 0.0_8
      coeffs(i, j, 3, 12) = zero
      coeffsd(i, j, 4, 12) = 0.0_8
      coeffs(i, j, 4, 12) = zero
      coeffsd(i, j, 5, 12) = -(gradw(i, j, 2)*mud(i, j)+mu(i, j)*gradwd(&
&       i, j, 2))
      coeffs(i, j, 5, 12) = -(mu(i, j)*gradw(i, j, 2))
      coeffsd(i, j, 1, 13) = 0.0_8
      coeffs(i, j, 1, 13) = zero
      coeffsd(i, j, 2, 13) = 0.0_8
      coeffs(i, j, 2, 13) = zero
      coeffsd(i, j, 3, 13) = 0.0_8
      coeffs(i, j, 3, 13) = zero
      coeffsd(i, j, 4, 13) = 0.0_8
      coeffs(i, j, 4, 13) = zero
      coeffsd(i, j, 5, 13) = -velyd(i, j)
      coeffs(i, j, 5, 13) = -vely(i, j)
      coeffsd(i, j, 1, 14) = 0.0_8
      coeffs(i, j, 1, 14) = zero
      coeffsd(i, j, 2, 14) = 0.0_8
      coeffs(i, j, 2, 14) = zero
      coeffsd(i, j, 3, 14) = 0.0_8
      coeffs(i, j, 3, 14) = zero
      coeffsd(i, j, 4, 14) = 0.0_8
      coeffs(i, j, 4, 14) = zero
      temp = gradu(i, j, 1) + gradv(i, j, 2)
      coeffsd(i, j, 5, 14) = twothird*(temp*mud(i, j)+mu(i, j)*(gradud(i&
&       , j, 1)+gradvd(i, j, 2)))
      coeffs(i, j, 5, 14) = twothird*(mu(i, j)*temp)
      coeffsd(i, j, 1, 15) = 0.0_8
      coeffs(i, j, 1, 15) = zero
      coeffsd(i, j, 2, 15) = 0.0_8
      coeffs(i, j, 2, 15) = zero
      coeffsd(i, j, 3, 15) = 0.0_8
      coeffs(i, j, 3, 15) = zero
      coeffsd(i, j, 4, 15) = 0.0_8
      coeffs(i, j, 4, 15) = zero
      temp = gradu(i, j, 1) + gradv(i, j, 2)
      coeffsd(i, j, 5, 15) = twothird*(temp*velzd(i, j)+velz(i, j)*(&
&       gradud(i, j, 1)+gradvd(i, j, 2)))
      coeffs(i, j, 5, 15) = twothird*(velz(i, j)*temp)
      coeffsd(i, j, 1, 16) = 0.0_8
      coeffs(i, j, 1, 16) = zero
      coeffsd(i, j, 2, 16) = 0.0_8
      coeffs(i, j, 2, 16) = zero
      coeffsd(i, j, 3, 16) = 0.0_8
      coeffs(i, j, 3, 16) = zero
      coeffsd(i, j, 4, 16) = 0.0_8
      coeffs(i, j, 4, 16) = zero
      coeffsd(i, j, 5, 16) = twothird*(velz(i, j)*mud(i, j)+mu(i, j)*&
&       velzd(i, j))
      coeffs(i, j, 5, 16) = twothird*mu(i, j)*velz(i, j)
    END DO
  END DO
!
  CALL FUNCTION_5P_DZ_D_D(func0, func0d, func0dd, func1, func1d, func1dd&
&                   , func2, func2d, func2dd, func3, func3d, func3dd, &
&                   func4, func4d, func4dd, func5, func5d, func5dd, &
&                   func6, func6d, func6dd, func7, func7d, func7dd, &
&                   func8, func8d, func8dd, func9, func9d, func9dd, &
&                   func10, func10d, func10dd, func11, func11d, func11dd&
&                   , func12, func12d, func12dd, func13, func13d, &
&                   func13dd, func14, func14d, func14dd, func15, func15d&
&                   , func15dd, w, wd0, wd, x0, y0, nx, ny, xc, yc, vol&
&                   , volf, gh, cp, cv, prandtl, gam, rgaz, cs, muref, &
&                   tref, s_suth, im, jm)
  dz_outd = 0.0_8
  DO j=1,jm
!DIR$ IVDEP
    DO i=1,im
!
      dz_outd(i, j, 1) = func0d(i, j, 1)*coeffsd(i, j, 1, 1) + coeffs(i&
&       , j, 1, 1)*func0dd(i, j, 1) + func1d(i, j, 1)*coeffsd(i, j, 1, 2&
&       ) + coeffs(i, j, 1, 2)*func1dd(i, j, 1) + func2d(i, j, 1)*&
&       coeffsd(i, j, 1, 3) + coeffs(i, j, 1, 3)*func2dd(i, j, 1) + &
&       func3d(i, j, 1)*coeffsd(i, j, 1, 4) + coeffs(i, j, 1, 4)*func3dd&
&       (i, j, 1) + func4d(i, j, 1)*coeffsd(i, j, 1, 5) + coeffs(i, j, 1&
&       , 5)*func4dd(i, j, 1) + func5d(i, j, 1)*coeffsd(i, j, 1, 6) + &
&       coeffs(i, j, 1, 6)*func5dd(i, j, 1) + func6d(i, j, 1)*coeffsd(i&
&       , j, 1, 7) + coeffs(i, j, 1, 7)*func6dd(i, j, 1) + func7d(i, j, &
&       1)*coeffsd(i, j, 1, 8) + coeffs(i, j, 1, 8)*func7dd(i, j, 1) + &
&       func8d(i, j, 1)*coeffsd(i, j, 1, 9) + coeffs(i, j, 1, 9)*func8dd&
&       (i, j, 1) + func9d(i, j, 1)*coeffsd(i, j, 1, 10) + coeffs(i, j, &
&       1, 10)*func9dd(i, j, 1) + func10d(i, j, 1)*coeffsd(i, j, 1, 11) &
&       + coeffs(i, j, 1, 11)*func10dd(i, j, 1) + func11d(i, j, 1)*&
&       coeffsd(i, j, 1, 12) + coeffs(i, j, 1, 12)*func11dd(i, j, 1) + &
&       func12d(i, j, 1)*coeffsd(i, j, 1, 13) + coeffs(i, j, 1, 13)*&
&       func12dd(i, j, 1) + func13d(i, j, 1)*coeffsd(i, j, 1, 14) + &
&       coeffs(i, j, 1, 14)*func13dd(i, j, 1) + func14d(i, j, 1)*coeffsd&
&       (i, j, 1, 15) + coeffs(i, j, 1, 15)*func14dd(i, j, 1) + func15d(&
&       i, j, 1)*coeffsd(i, j, 1, 16) + coeffs(i, j, 1, 16)*func15dd(i, &
&       j, 1)
      dz_outd(i, j, 2) = func0d(i, j, 2)*coeffsd(i, j, 2, 1) + coeffs(i&
&       , j, 2, 1)*func0dd(i, j, 2) + func1d(i, j, 2)*coeffsd(i, j, 2, 2&
&       ) + coeffs(i, j, 2, 2)*func1dd(i, j, 2) + func2d(i, j, 2)*&
&       coeffsd(i, j, 2, 3) + coeffs(i, j, 2, 3)*func2dd(i, j, 2) + &
&       func3d(i, j, 2)*coeffsd(i, j, 2, 4) + coeffs(i, j, 2, 4)*func3dd&
&       (i, j, 2) + func4d(i, j, 2)*coeffsd(i, j, 2, 5) + coeffs(i, j, 2&
&       , 5)*func4dd(i, j, 2) + func5d(i, j, 2)*coeffsd(i, j, 2, 6) + &
&       coeffs(i, j, 2, 6)*func5dd(i, j, 2) + func6d(i, j, 2)*coeffsd(i&
&       , j, 2, 7) + coeffs(i, j, 2, 7)*func6dd(i, j, 2) + func7d(i, j, &
&       2)*coeffsd(i, j, 2, 8) + coeffs(i, j, 2, 8)*func7dd(i, j, 2) + &
&       func8d(i, j, 2)*coeffsd(i, j, 2, 9) + coeffs(i, j, 2, 9)*func8dd&
&       (i, j, 2) + func9d(i, j, 2)*coeffsd(i, j, 2, 10) + coeffs(i, j, &
&       2, 10)*func9dd(i, j, 2) + func10d(i, j, 2)*coeffsd(i, j, 2, 11) &
&       + coeffs(i, j, 2, 11)*func10dd(i, j, 2) + func11d(i, j, 2)*&
&       coeffsd(i, j, 2, 12) + coeffs(i, j, 2, 12)*func11dd(i, j, 2) + &
&       func12d(i, j, 2)*coeffsd(i, j, 2, 13) + coeffs(i, j, 2, 13)*&
&       func12dd(i, j, 2) + func13d(i, j, 2)*coeffsd(i, j, 2, 14) + &
&       coeffs(i, j, 2, 14)*func13dd(i, j, 2) + func14d(i, j, 2)*coeffsd&
&       (i, j, 2, 15) + coeffs(i, j, 2, 15)*func14dd(i, j, 2) + func15d(&
&       i, j, 2)*coeffsd(i, j, 2, 16) + coeffs(i, j, 2, 16)*func15dd(i, &
&       j, 2)
      dz_outd(i, j, 3) = func0d(i, j, 3)*coeffsd(i, j, 3, 1) + coeffs(i&
&       , j, 3, 1)*func0dd(i, j, 3) + func1d(i, j, 3)*coeffsd(i, j, 3, 2&
&       ) + coeffs(i, j, 3, 2)*func1dd(i, j, 3) + func2d(i, j, 3)*&
&       coeffsd(i, j, 3, 3) + coeffs(i, j, 3, 3)*func2dd(i, j, 3) + &
&       func3d(i, j, 3)*coeffsd(i, j, 3, 4) + coeffs(i, j, 3, 4)*func3dd&
&       (i, j, 3) + func4d(i, j, 3)*coeffsd(i, j, 3, 5) + coeffs(i, j, 3&
&       , 5)*func4dd(i, j, 3) + func5d(i, j, 3)*coeffsd(i, j, 3, 6) + &
&       coeffs(i, j, 3, 6)*func5dd(i, j, 3) + func6d(i, j, 3)*coeffsd(i&
&       , j, 3, 7) + coeffs(i, j, 3, 7)*func6dd(i, j, 3) + func7d(i, j, &
&       3)*coeffsd(i, j, 3, 8) + coeffs(i, j, 3, 8)*func7dd(i, j, 3) + &
&       func8d(i, j, 3)*coeffsd(i, j, 3, 9) + coeffs(i, j, 3, 9)*func8dd&
&       (i, j, 3) + func9d(i, j, 3)*coeffsd(i, j, 3, 10) + coeffs(i, j, &
&       3, 10)*func9dd(i, j, 3) + func10d(i, j, 3)*coeffsd(i, j, 3, 11) &
&       + coeffs(i, j, 3, 11)*func10dd(i, j, 3) + func11d(i, j, 3)*&
&       coeffsd(i, j, 3, 12) + coeffs(i, j, 3, 12)*func11dd(i, j, 3) + &
&       func12d(i, j, 3)*coeffsd(i, j, 3, 13) + coeffs(i, j, 3, 13)*&
&       func12dd(i, j, 3) + func13d(i, j, 3)*coeffsd(i, j, 3, 14) + &
&       coeffs(i, j, 3, 14)*func13dd(i, j, 3) + func14d(i, j, 3)*coeffsd&
&       (i, j, 3, 15) + coeffs(i, j, 3, 15)*func14dd(i, j, 3) + func15d(&
&       i, j, 3)*coeffsd(i, j, 3, 16) + coeffs(i, j, 3, 16)*func15dd(i, &
&       j, 3)
      dz_outd(i, j, 4) = func0d(i, j, 4)*coeffsd(i, j, 4, 1) + coeffs(i&
&       , j, 4, 1)*func0dd(i, j, 4) + func1d(i, j, 4)*coeffsd(i, j, 4, 2&
&       ) + coeffs(i, j, 4, 2)*func1dd(i, j, 4) + func2d(i, j, 4)*&
&       coeffsd(i, j, 4, 3) + coeffs(i, j, 4, 3)*func2dd(i, j, 4) + &
&       func3d(i, j, 4)*coeffsd(i, j, 4, 4) + coeffs(i, j, 4, 4)*func3dd&
&       (i, j, 4) + func4d(i, j, 4)*coeffsd(i, j, 4, 5) + coeffs(i, j, 4&
&       , 5)*func4dd(i, j, 4) + func5d(i, j, 4)*coeffsd(i, j, 4, 6) + &
&       coeffs(i, j, 4, 6)*func5dd(i, j, 4) + func6d(i, j, 4)*coeffsd(i&
&       , j, 4, 7) + coeffs(i, j, 4, 7)*func6dd(i, j, 4) + func7d(i, j, &
&       4)*coeffsd(i, j, 4, 8) + coeffs(i, j, 4, 8)*func7dd(i, j, 4) + &
&       func8d(i, j, 4)*coeffsd(i, j, 4, 9) + coeffs(i, j, 4, 9)*func8dd&
&       (i, j, 4) + func9d(i, j, 4)*coeffsd(i, j, 4, 10) + coeffs(i, j, &
&       4, 10)*func9dd(i, j, 4) + func10d(i, j, 4)*coeffsd(i, j, 4, 11) &
&       + coeffs(i, j, 4, 11)*func10dd(i, j, 4) + func11d(i, j, 4)*&
&       coeffsd(i, j, 4, 12) + coeffs(i, j, 4, 12)*func11dd(i, j, 4) + &
&       func12d(i, j, 4)*coeffsd(i, j, 4, 13) + coeffs(i, j, 4, 13)*&
&       func12dd(i, j, 4) + func13d(i, j, 4)*coeffsd(i, j, 4, 14) + &
&       coeffs(i, j, 4, 14)*func13dd(i, j, 4) + func14d(i, j, 4)*coeffsd&
&       (i, j, 4, 15) + coeffs(i, j, 4, 15)*func14dd(i, j, 4) + func15d(&
&       i, j, 4)*coeffsd(i, j, 4, 16) + coeffs(i, j, 4, 16)*func15dd(i, &
&       j, 4)
      dz_outd(i, j, 5) = func0d(i, j, 5)*coeffsd(i, j, 5, 1) + coeffs(i&
&       , j, 5, 1)*func0dd(i, j, 5) + func1d(i, j, 5)*coeffsd(i, j, 5, 2&
&       ) + coeffs(i, j, 5, 2)*func1dd(i, j, 5) + func2d(i, j, 5)*&
&       coeffsd(i, j, 5, 3) + coeffs(i, j, 5, 3)*func2dd(i, j, 5) + &
&       func3d(i, j, 5)*coeffsd(i, j, 5, 4) + coeffs(i, j, 5, 4)*func3dd&
&       (i, j, 5) + func4d(i, j, 5)*coeffsd(i, j, 5, 5) + coeffs(i, j, 5&
&       , 5)*func4dd(i, j, 5) + func5d(i, j, 5)*coeffsd(i, j, 5, 6) + &
&       coeffs(i, j, 5, 6)*func5dd(i, j, 5) + func6d(i, j, 5)*coeffsd(i&
&       , j, 5, 7) + coeffs(i, j, 5, 7)*func6dd(i, j, 5) + func7d(i, j, &
&       5)*coeffsd(i, j, 5, 8) + coeffs(i, j, 5, 8)*func7dd(i, j, 5) + &
&       func8d(i, j, 5)*coeffsd(i, j, 5, 9) + coeffs(i, j, 5, 9)*func8dd&
&       (i, j, 5) + func9d(i, j, 5)*coeffsd(i, j, 5, 10) + coeffs(i, j, &
&       5, 10)*func9dd(i, j, 5) + func10d(i, j, 5)*coeffsd(i, j, 5, 11) &
&       + coeffs(i, j, 5, 11)*func10dd(i, j, 5) + func11d(i, j, 5)*&
&       coeffsd(i, j, 5, 12) + coeffs(i, j, 5, 12)*func11dd(i, j, 5) + &
&       func12d(i, j, 5)*coeffsd(i, j, 5, 13) + coeffs(i, j, 5, 13)*&
&       func12dd(i, j, 5) + func13d(i, j, 5)*coeffsd(i, j, 5, 14) + &
&       coeffs(i, j, 5, 14)*func13dd(i, j, 5) + func14d(i, j, 5)*coeffsd&
&       (i, j, 5, 15) + coeffs(i, j, 5, 15)*func14dd(i, j, 5) + func15d(&
&       i, j, 5)*coeffsd(i, j, 5, 16) + coeffs(i, j, 5, 16)*func15dd(i, &
&       j, 5)
    END DO
  END DO
END SUBROUTINE COEFFS_5P_DZ_D
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!  Differentiation of function_5p_dz_d in forward (tangent) mode (with options with!SliceDeadControl with!SliceDeadInstrs with!St
!aticTaping):
!   variations   of useful results: func0d func13d func10d func7d
!                func4d func1d func14d func11d func8d func5d func2d
!                func15d func12d func9d func6d func3d
!   with respect to varying inputs: w
! =============================================================================
!          consistent fluxes for DNC3 2D
! =============================================================================
!
!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.16 (master) -  9 Oct 2020 17:47
!
!  Differentiation of function_5p_dz in forward (tangent) mode (with options with!SliceDeadControl with!SliceDeadInstrs with!Stat
!icTaping):
!   variations   of useful results: func0 func1 func2 func3 func4
!                func5 func6 func7 func8 func9 func10 func11 func12
!                func13 func14 func15
!   with respect to varying inputs: w
!   RW status of diff variables: func0:out func1:out func2:out
!                w:in func3:out func4:out func5:out func6:out func7:out
!                func8:out func9:out func10:out func11:out func12:out
!                func13:out func14:out func15:out
! =============================================================================
!          consistent fluxes for DNC3 2D
! =============================================================================
!
SUBROUTINE FUNCTION_5P_DZ_D_D(func0, func0d, func0dd, func1, func1d, &
& func1dd, func2, func2d, func2dd, func3, func3d, func3dd, func4, func4d&
& , func4dd, func5, func5d, func5dd, func6, func6d, func6dd, func7, &
& func7d, func7dd, func8, func8d, func8dd, func9, func9d, func9dd, &
& func10, func10d, func10dd, func11, func11d, func11dd, func12, func12d&
& , func12dd, func13, func13d, func13dd, func14, func14d, func14dd, &
& func15, func15d, func15dd, w, wd0, wd, x0, y0, nx, ny, xc, yc, vol, &
& volf, gh, cp, cv, prandtl, gam, rgaz, cs, muref, tref, s_suth, im, jm)
  IMPLICIT NONE
!
! variables for dimension -----------------------------------------
  INTEGER :: im, jm, gh
! required arguments ----------------------------------------------
! thermo
  REAL*8, INTENT(IN) :: cp, cv, prandtl, gam, rgaz
! viscosity
  REAL*8, INTENT(IN) :: cs, muref, tref, s_suth
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1), INTENT(IN) :: x0
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1), INTENT(IN) :: y0
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1, 2), INTENT(IN) :: nx
  REAL*8, DIMENSION(1-gh:im+gh+1, 1-gh:jm+gh+1, 2), INTENT(IN) :: ny
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh), INTENT(IN) :: xc
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh), INTENT(IN) :: yc
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh), INTENT(IN) :: vol
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 2), INTENT(IN) :: volf
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5), INTENT(IN) :: w
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5), INTENT(IN) :: wd0
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5), INTENT(IN) :: wd
! Returned objects ------------------------------------------------
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func0
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func0d
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func0dd
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func1
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func1d
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func1dd
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func2
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func2d
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func2dd
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func3
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func3d
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func3dd
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func4
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func4d
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func4dd
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func5
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func5d
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func5dd
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func6
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func6d
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func6dd
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func7
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func7d
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func7dd
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func8
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func8d
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func8dd
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func9
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func9d
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func9dd
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func10
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func10d
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func10dd
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func11
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func11d
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func11dd
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func12
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func12d
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func12dd
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func13
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func13d
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func13dd
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func14
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func14d
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func14dd
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func15
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func15d
  REAL*8, DIMENSION(im, jm, 5), INTENT(INOUT) :: func15dd
! Non-required arguments -------------------------------------------
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 5) :: f, g
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velx
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velxd0
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velxd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velxdd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: vely
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velyd0
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velyd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velydd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velz
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velzd0
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velzd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: velzdd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: tloc
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: tlocd0
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: tlocd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: tlocdd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: p
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: pd0
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: pd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: pdd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: mu
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: mud0
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: mud
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh) :: mudd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 2) :: gradu, gradv, gradw, &
& gradmu
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 2) :: gradud0, gradvd0, &
& gradwd0
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 2) :: gradud, gradvd, gradwd
  REAL*8, DIMENSION(1-gh:im+gh, 1-gh:jm+gh, 2) :: gradudd, gradvdd, &
& gradwdd
  INTEGER :: i, j, h
  REAL*8 :: nx_n, nx_s, nx_e, nx_o, volm1, ux, vx, wx, tx
  REAL*8 :: ny_n, ny_s, ny_e, ny_o, uy, vy, wy, ty
  REAL*8 :: val_n, val_s, val_e, val_o
  REAL*8 :: fxro1, fxro2, fxrou1, fxrou2, fxrov1, fxrov2, fxrow1, fxrow2&
& , fxroe1, fxroe2
  REAL*8 :: dissro1, dissro2, dissrou1, dissrou2, dissrov1, dissrov2, &
& dissrow1, dissrow2, dissroe1, dissroe2
  REAL*8 :: fvro1, fvro2, fvrou1, fvrou2, fvrov1, fvrov2, fvrow1, fvrow2&
& , fvroe1, fvroe2
  REAL*8 :: gvro1, gvro2, gvrou1, gvrou2, gvrov1, gvrov2, gvrow1, gvrow2&
& , gvroe1, gvroe2
  REAL*8 :: cpprandtl, mmu, lambda, uu, vv, ww, ro, rom1, htot, eloc, ec
  REAL*8 :: rod0, rom1d0, elocd0, ecd0
  REAL*8 :: rod, rom1d, elocd, ecd
  REAL*8 :: rom1dd, elocdd, ecdd
  REAL*8 :: predro1, predrou1, predrov1, predrow1, predroe1, eps2, eps4
  REAL*8 :: predro2, predrou2, predrov2, predrow2, predroe2, rspec
  REAL*8 :: divu2, vort2, dx, dy, dxm1, dym1, dxm2, dym2
  REAL*8 :: gui, gvi, gwi, gmui
  REAL*8 :: guid0, gvid0, gwid0
  REAL*8 :: guid, gvid, gwid
  REAL*8 :: guidd, gvidd, gwidd
  REAL*8 :: guj, gvj, gwj, gmuj
  REAL*8 :: gujd0, gvjd0, gwjd0
  REAL*8 :: gujd, gvjd, gwjd
  REAL*8 :: gujdd, gvjdd, gwjdd
  REAL*8 :: rhom, rhomr, rhoml, rhom1l, c2l, c2r, rr, r, u, ur, ul, vr, &
& vl, wr, wl, c2x, nx2, ny2
  REAL*8 :: ab, sq, ducros1, ducros2, k_sensor1, k_sensor2
  REAL*8 :: b1, b2, b3, b4, b5, c1, c2, c3, c4, c5, wiggle, denom, betas
  REAL*8 :: nxloc, nyloc, sn, invsn, sc1, sc2
  REAL*8 :: d1, d2
  REAL*8 :: c3d0, c3d1
  REAL*8 :: pw, ct0, ct1, ct2, cvm1
  REAL*8 :: coef, omrr, test, diffro, diffrou, diffrov, diffrow, diffroe&
& , v
  REAL*8 :: half, one, zero, two, twothird, fourth, twelfth
  REAL*8 :: twentyfourth, ccross
  INTRINSIC SQRT
  REAL*8 :: result1
  REAL*8 :: result1d0
  REAL*8 :: result1d
  REAL*8 :: result1dd
  REAL*8 :: temp
  REAL*8 :: tempd
  REAL*8 :: temp0
  REAL*8 :: temp1
  REAL*8 :: temp2
! -----------------------------------------------------------------
!
  half = 0.5d0
  one = 1.d0
  twothird = 2.d0/3.d0
  cvm1 = one/cv
! Coef for grad o4
  denom = 1.d0/12.d0
  b1 = 8.d0*denom
  b2 = -denom
! Primitives
! for Sutherland
  result1 = SQRT(tref)
  betas = muref*(tref+cs)/(result1*tref)
  pd = 0.0_8
  velxd = 0.0_8
  velyd = 0.0_8
  velzd = 0.0_8
  mud = 0.0_8
  tlocdd = 0.0_8
  velydd = 0.0_8
  pd0 = 0.0_8
  velzdd = 0.0_8
  velxd0 = 0.0_8
  velyd0 = 0.0_8
  velzd0 = 0.0_8
  pdd = 0.0_8
  mudd = 0.0_8
  velxdd = 0.0_8
  tlocd0 = 0.0_8
  mud0 = 0.0_8
  DO j=1-gh,jm+gh
!DIR$ IVDEP
    DO i=1-gh,im+gh
      rod = wd(i, j, 1)
      rod0 = wd0(i, j, 1)
      ro = w(i, j, 1)
      temp0 = one*rod/(ro*ro)
      rom1dd = temp0*2*rod0/ro
      rom1d = -temp0
      rom1d0 = -(one*rod0/ro**2)
      rom1 = one/ro
      velxdd(i, j) = wd(i, j, 2)*rom1d0 + rom1d*wd0(i, j, 2) + w(i, j, 2&
&       )*rom1dd
      velxd(i, j) = rom1*wd(i, j, 2) + w(i, j, 2)*rom1d
      velxd0(i, j) = rom1*wd0(i, j, 2) + w(i, j, 2)*rom1d0
      velx(i, j) = w(i, j, 2)*rom1
      velydd(i, j) = wd(i, j, 3)*rom1d0 + rom1d*wd0(i, j, 3) + w(i, j, 3&
&       )*rom1dd
      velyd(i, j) = rom1*wd(i, j, 3) + w(i, j, 3)*rom1d
      velyd0(i, j) = rom1*wd0(i, j, 3) + w(i, j, 3)*rom1d0
      vely(i, j) = w(i, j, 3)*rom1
      velzdd(i, j) = wd(i, j, 4)*rom1d0 + rom1d*wd0(i, j, 4) + w(i, j, 4&
&       )*rom1dd
      velzd(i, j) = rom1*wd(i, j, 4) + w(i, j, 4)*rom1d
      velzd0(i, j) = rom1*wd0(i, j, 4) + w(i, j, 4)*rom1d0
      velz(i, j) = w(i, j, 4)*rom1
!
      temp0 = 2*velx(i, j)
      temp1 = 2*vely(i, j)
      temp2 = 2*velz(i, j)
      ecdd = half*(velxd(i, j)*2*velxd0(i, j)+temp0*velxdd(i, j)+velyd(i&
&       , j)*2*velyd0(i, j)+temp1*velydd(i, j)+velzd(i, j)*2*velzd0(i, j&
&       )+temp2*velzdd(i, j))
      ecd = half*(temp0*velxd(i, j)+temp1*velyd(i, j)+temp2*velzd(i, j))
      ecd0 = half*(2*velx(i, j)*velxd0(i, j)+2*vely(i, j)*velyd0(i, j)+2&
&       *velz(i, j)*velzd0(i, j))
      ec = half*(velx(i, j)*velx(i, j)+vely(i, j)*vely(i, j)+velz(i, j)*&
&       velz(i, j))
! ec  = HALF*( velx(i,j)*velx(i,j) &
!            + vely(i,j)*vely(i,j))
!
      tempd = wd0(i, j, 5) - ro*ecd0 - ec*rod0
      temp = w(i, j, 5) - ec*ro
      temp2 = wd(i, j, 5) - ro*ecd - rod*ec
      elocdd = temp2*rom1d0 + rom1*(-(ecd*rod0)-ro*ecdd-rod*ecd0) + &
&       rom1d*tempd + temp*rom1dd
      elocd = rom1*temp2 + temp*rom1d
      elocd0 = rom1*tempd + temp*rom1d0
      eloc = temp*rom1
!
      tlocdd(i, j) = cvm1*elocdd
      tlocd(i, j) = cvm1*elocd
      tlocd0(i, j) = cvm1*elocd0
      tloc(i, j) = eloc*cvm1
!
      pdd(i, j) = (gam-one)*(rod*elocd0+elocd*rod0+ro*elocdd)
      pd(i, j) = (gam-one)*(eloc*rod+ro*elocd)
      pd0(i, j) = (gam-one)*(eloc*rod0+ro*elocd0)
      p(i, j) = (gam-one)*ro*eloc
!  p(i,j)  = ro*rgaz*tloc(i,j)
!h(i,j,1)  = w(i,j,4)
!h(i,j,2)  = w(i,j,4) * velx(i,j)
!h(i,j,3)  = w(i,j,4) * vely(i,j)
!h(i,j,4)  = w(i,j,4) * velz(i,j) + p(i,j)
!h(i,j,5)  = w(i,j,4) * htot
      temp2 = SQRT(tloc(i, j))
      IF (tloc(i, j) .EQ. 0.0) THEN
        tempd = 0.0_8
      ELSE
        tempd = tlocd0(i, j)/(2.0*temp2)
      END IF
      temp = temp2
      IF (tloc(i, j) .EQ. 0.0) THEN
        result1d = 0.0_8
        result1dd = 0.0_8
      ELSE
        temp2 = tlocd(i, j)/(2.0*temp)
        result1dd = (tlocdd(i, j)-temp2*2.0*tempd)/(2.0*temp)
        result1d = temp2
      END IF
      result1d0 = tempd
      result1 = temp
      temp2 = result1*tloc(i, j)/(s_suth+tloc(i, j))
      tempd = (tloc(i, j)*result1d0+(result1-temp2)*tlocd0(i, j))/(&
&       s_suth+tloc(i, j))
      temp = temp2
      temp2 = (tloc(i, j)*result1d+(result1-temp)*tlocd(i, j))/(s_suth+&
&       tloc(i, j))
      mudd(i, j) = betas*((result1d-temp2)*tlocd0(i, j)+tloc(i, j)*&
&       result1dd+tlocd(i, j)*(result1d0-tempd)+(result1-temp)*tlocdd(i&
&       , j))/(s_suth+tloc(i, j))
      mud(i, j) = betas*temp2
      mud0(i, j) = betas*tempd
      mu(i, j) = betas*temp
    END DO
  END DO
  gradud = 0.0_8
  gradvd = 0.0_8
  gradwd = 0.0_8
  gradudd = 0.0_8
  gradvdd = 0.0_8
  gradwdd = 0.0_8
  gradud0 = 0.0_8
  gradvd0 = 0.0_8
  gradwd0 = 0.0_8
! Work on interior domain minus one cell
  DO j=1,jm
!DIR$ IVDEP
    DO i=1,im
!idir
      guidd = b1*(velxdd(i+1, j)-velxdd(i-1, j)) + b2*(velxdd(i+2, j)-&
&       velxdd(i-2, j))
      guid = b1*(velxd(i+1, j)-velxd(i-1, j)) + b2*(velxd(i+2, j)-velxd(&
&       i-2, j))
      guid0 = b1*(velxd0(i+1, j)-velxd0(i-1, j)) + b2*(velxd0(i+2, j)-&
&       velxd0(i-2, j))
      gui = b1*(velx(i+1, j)-velx(i-1, j)) + b2*(velx(i+2, j)-velx(i-2, &
&       j))
      gvidd = b1*(velydd(i+1, j)-velydd(i-1, j)) + b2*(velydd(i+2, j)-&
&       velydd(i-2, j))
      gvid = b1*(velyd(i+1, j)-velyd(i-1, j)) + b2*(velyd(i+2, j)-velyd(&
&       i-2, j))
      gvid0 = b1*(velyd0(i+1, j)-velyd0(i-1, j)) + b2*(velyd0(i+2, j)-&
&       velyd0(i-2, j))
      gvi = b1*(vely(i+1, j)-vely(i-1, j)) + b2*(vely(i+2, j)-vely(i-2, &
&       j))
      gwidd = b1*(velzdd(i+1, j)-velzdd(i-1, j)) + b2*(velzdd(i+2, j)-&
&       velzdd(i-2, j))
      gwid = b1*(velzd(i+1, j)-velzd(i-1, j)) + b2*(velzd(i+2, j)-velzd(&
&       i-2, j))
      gwid0 = b1*(velzd0(i+1, j)-velzd0(i-1, j)) + b2*(velzd0(i+2, j)-&
&       velzd0(i-2, j))
      gwi = b1*(velz(i+1, j)-velz(i-1, j)) + b2*(velz(i+2, j)-velz(i-2, &
&       j))
!jdir
      gujdd = b1*(velxdd(i, j+1)-velxdd(i, j-1)) + b2*(velxdd(i, j+2)-&
&       velxdd(i, j-2))
      gujd = b1*(velxd(i, j+1)-velxd(i, j-1)) + b2*(velxd(i, j+2)-velxd(&
&       i, j-2))
      gujd0 = b1*(velxd0(i, j+1)-velxd0(i, j-1)) + b2*(velxd0(i, j+2)-&
&       velxd0(i, j-2))
      guj = b1*(velx(i, j+1)-velx(i, j-1)) + b2*(velx(i, j+2)-velx(i, j-&
&       2))
      gvjdd = b1*(velydd(i, j+1)-velydd(i, j-1)) + b2*(velydd(i, j+2)-&
&       velydd(i, j-2))
      gvjd = b1*(velyd(i, j+1)-velyd(i, j-1)) + b2*(velyd(i, j+2)-velyd(&
&       i, j-2))
      gvjd0 = b1*(velyd0(i, j+1)-velyd0(i, j-1)) + b2*(velyd0(i, j+2)-&
&       velyd0(i, j-2))
      gvj = b1*(vely(i, j+1)-vely(i, j-1)) + b2*(vely(i, j+2)-vely(i, j-&
&       2))
      gwjdd = b1*(velzdd(i, j+1)-velzdd(i, j-1)) + b2*(velzdd(i, j+2)-&
&       velzdd(i, j-2))
      gwjd = b1*(velzd(i, j+1)-velzd(i, j-1)) + b2*(velzd(i, j+2)-velzd(&
&       i, j-2))
      gwjd0 = b1*(velzd0(i, j+1)-velzd0(i, j-1)) + b2*(velzd0(i, j+2)-&
&       velzd0(i, j-2))
      gwj = b1*(velz(i, j+1)-velz(i, j-1)) + b2*(velz(i, j+2)-velz(i, j-&
&       2))
      volm1 = one/vol(i, j)
      dxm1 = half*(nx(i, j, 1)+nx(i+1, j, 1))*volm1
      dxm2 = half*(nx(i, j, 2)+nx(i, j+1, 2))*volm1
      dym1 = half*(ny(i, j, 1)+ny(i+1, j, 1))*volm1
      dym2 = half*(ny(i, j, 2)+ny(i, j+1, 2))*volm1
      gradudd(i, j, 1) = dxm1*guidd + dxm2*gujdd
      gradud(i, j, 1) = dxm1*guid + dxm2*gujd
      gradud0(i, j, 1) = dxm1*guid0 + dxm2*gujd0
      gradu(i, j, 1) = dxm1*gui + dxm2*guj
      gradvdd(i, j, 1) = dxm1*gvidd + dxm2*gvjdd
      gradvd(i, j, 1) = dxm1*gvid + dxm2*gvjd
      gradvd0(i, j, 1) = dxm1*gvid0 + dxm2*gvjd0
      gradv(i, j, 1) = dxm1*gvi + dxm2*gvj
      gradwdd(i, j, 1) = dxm1*gwidd + dxm2*gwjdd
      gradwd(i, j, 1) = dxm1*gwid + dxm2*gwjd
      gradwd0(i, j, 1) = dxm1*gwid0 + dxm2*gwjd0
      gradw(i, j, 1) = dxm1*gwi + dxm2*gwj
      gradudd(i, j, 2) = dym1*guidd + dym2*gujdd
      gradud(i, j, 2) = dym1*guid + dym2*gujd
      gradud0(i, j, 2) = dym1*guid0 + dym2*gujd0
      gradu(i, j, 2) = dym1*gui + dym2*guj
      gradvdd(i, j, 2) = dym1*gvidd + dym2*gvjdd
      gradvd(i, j, 2) = dym1*gvid + dym2*gvjd
      gradvd0(i, j, 2) = dym1*gvid0 + dym2*gvjd0
      gradv(i, j, 2) = dym1*gvi + dym2*gvj
      gradwdd(i, j, 2) = dym1*gwidd + dym2*gwjdd
      gradwd(i, j, 2) = dym1*gwid + dym2*gwjd
      gradwd0(i, j, 2) = dym1*gwid0 + dym2*gwjd0
      gradw(i, j, 2) = dym1*gwi + dym2*gwj
    END DO
  END DO
  func0d = 0.0_8
  func1d = 0.0_8
  func2d = 0.0_8
  func3d = 0.0_8
  func4d = 0.0_8
  func5d = 0.0_8
  func6d = 0.0_8
  func7d = 0.0_8
  func8d = 0.0_8
  func9d = 0.0_8
  func10d = 0.0_8
  func11d = 0.0_8
  func12d = 0.0_8
  func13d = 0.0_8
  func14d = 0.0_8
  func15d = 0.0_8
  func0dd = 0.0_8
  func13dd = 0.0_8
  func10dd = 0.0_8
  func7dd = 0.0_8
  func4dd = 0.0_8
  func1dd = 0.0_8
  func14dd = 0.0_8
  func11dd = 0.0_8
  func8dd = 0.0_8
  func5dd = 0.0_8
  func2dd = 0.0_8
  func15dd = 0.0_8
  func12dd = 0.0_8
  func9dd = 0.0_8
  func6dd = 0.0_8
  func3dd = 0.0_8
  DO j=1,jm
!DIR$ IVDEP
    DO i=1,im
!
      func0dd(i, j, 1) = 0.0_8
      func0d(i, j, 1) = wd(i, j, 4)
      func0dd(i, j, 2) = wd(i, j, 2)*velzd0(i, j) + velzd(i, j)*wd0(i, j&
&       , 2) + w(i, j, 2)*velzdd(i, j) - mud(i, j)*gradwd0(i, j, 1) - &
&       gradw(i, j, 1)*mudd(i, j) - gradwd(i, j, 1)*mud0(i, j) - mu(i, j&
&       )*gradwdd(i, j, 1)
      func0d(i, j, 2) = velz(i, j)*wd(i, j, 2) + w(i, j, 2)*velzd(i, j) &
&       - gradw(i, j, 1)*mud(i, j) - mu(i, j)*gradwd(i, j, 1)
      func0dd(i, j, 3) = wd(i, j, 3)*velzd0(i, j) + velzd(i, j)*wd0(i, j&
&       , 3) + w(i, j, 3)*velzdd(i, j) - mud(i, j)*gradwd0(i, j, 2) - &
&       gradw(i, j, 2)*mudd(i, j) - gradwd(i, j, 2)*mud0(i, j) - mu(i, j&
&       )*gradwdd(i, j, 2)
      func0d(i, j, 3) = velz(i, j)*wd(i, j, 3) + w(i, j, 3)*velzd(i, j) &
&       - gradw(i, j, 2)*mud(i, j) - mu(i, j)*gradwd(i, j, 2)
      tempd = gradud0(i, j, 1) + gradvd0(i, j, 2)
      temp = gradu(i, j, 1) + gradv(i, j, 2)
      temp2 = gradud(i, j, 1) + gradvd(i, j, 2)
      func0dd(i, j, 4) = wd(i, j, 4)*velzd0(i, j) + velzd(i, j)*wd0(i, j&
&       , 4) + w(i, j, 4)*velzdd(i, j) + pdd(i, j) + twothird*(mud(i, j)&
&       *tempd+temp*mudd(i, j)+temp2*mud0(i, j)+mu(i, j)*(gradudd(i, j, &
&       1)+gradvdd(i, j, 2)))
      func0d(i, j, 4) = wd(i, j, 4)*velz(i, j) + w(i, j, 4)*velzd(i, j) &
&       + pd(i, j) + twothird*(temp*mud(i, j)+mu(i, j)*temp2)
      tempd = wd0(i, j, 5) + pd0(i, j)
      temp = w(i, j, 5) + p(i, j)
      temp2 = wd(i, j, 5) + pd(i, j)
      func0dd(i, j, 5) = temp2*velzd0(i, j) + velz(i, j)*pdd(i, j) + &
&       velzd(i, j)*tempd + temp*velzdd(i, j)
      func0d(i, j, 5) = velz(i, j)*temp2 + temp*velzd(i, j)
      func1dd(i, j, 1) = 0.0_8
      func1d(i, j, 1) = 0.0_8
      func1dd(i, j, 2) = velzdd(i, j)
      func1d(i, j, 2) = velzd(i, j)
      func1dd(i, j, 3) = velzdd(i, j)
      func1d(i, j, 3) = velzd(i, j)
      func1dd(i, j, 4) = velxdd(i, j)
      func1d(i, j, 4) = velxd(i, j)
      func1dd(i, j, 5) = velzdd(i, j)
      func1d(i, j, 5) = velzd(i, j)
      func2dd(i, j, 1) = 0.0_8
      func2d(i, j, 1) = 0.0_8
      func2dd(i, j, 2) = gradwdd(i, j, 1)
      func2d(i, j, 2) = gradwd(i, j, 1)
      func2dd(i, j, 3) = gradwdd(i, j, 2)
      func2d(i, j, 3) = gradwd(i, j, 2)
      func2dd(i, j, 4) = velydd(i, j)
      func2d(i, j, 4) = velyd(i, j)
      func2dd(i, j, 5) = gradwdd(i, j, 1)
      func2d(i, j, 5) = gradwd(i, j, 1)
      func3dd(i, j, 1) = 0.0_8
      func3d(i, j, 1) = 0.0_8
      func3dd(i, j, 2) = 0.0_8
      func3d(i, j, 2) = 0.0_8
      func3dd(i, j, 3) = 0.0_8
      func3d(i, j, 3) = 0.0_8
      func3dd(i, j, 4) = gradudd(i, j, 1) + gradvdd(i, j, 2)
      func3d(i, j, 4) = gradud(i, j, 1) + gradvd(i, j, 2)
      func3dd(i, j, 5) = velxdd(i, j)
      func3d(i, j, 5) = velxd(i, j)
      func4dd(i, j, 1) = 0.0_8
      func4d(i, j, 1) = 0.0_8
      func4dd(i, j, 2) = 0.0_8
      func4d(i, j, 2) = 0.0_8
      func4dd(i, j, 3) = 0.0_8
      func4d(i, j, 3) = 0.0_8
      func4dd(i, j, 4) = 0.0_8
      func4d(i, j, 4) = 0.0_8
      func4dd(i, j, 5) = gradudd(i, j, 1)
      func4d(i, j, 5) = gradud(i, j, 1)
      func5dd(i, j, 1) = 0.0_8
      func5d(i, j, 1) = 0.0_8
      func5dd(i, j, 2) = 0.0_8
      func5d(i, j, 2) = 0.0_8
      func5dd(i, j, 3) = 0.0_8
      func5d(i, j, 3) = 0.0_8
      func5dd(i, j, 4) = 0.0_8
      func5d(i, j, 4) = 0.0_8
      func5dd(i, j, 5) = velzdd(i, j)
      func5d(i, j, 5) = velzd(i, j)
      func6dd(i, j, 1) = 0.0_8
      func6d(i, j, 1) = 0.0_8
      func6dd(i, j, 2) = 0.0_8
      func6d(i, j, 2) = 0.0_8
      func6dd(i, j, 3) = 0.0_8
      func6d(i, j, 3) = 0.0_8
      func6dd(i, j, 4) = 0.0_8
      func6d(i, j, 4) = 0.0_8
      func6dd(i, j, 5) = gradwdd(i, j, 2)
      func6d(i, j, 5) = gradwd(i, j, 2)
      func7dd(i, j, 1) = 0.0_8
      func7d(i, j, 1) = 0.0_8
      func7dd(i, j, 2) = 0.0_8
      func7d(i, j, 2) = 0.0_8
      func7dd(i, j, 3) = 0.0_8
      func7d(i, j, 3) = 0.0_8
      func7dd(i, j, 4) = 0.0_8
      func7d(i, j, 4) = 0.0_8
      func7dd(i, j, 5) = velydd(i, j)
      func7d(i, j, 5) = velyd(i, j)
      func8dd(i, j, 1) = 0.0_8
      func8d(i, j, 1) = 0.0_8
      func8dd(i, j, 2) = 0.0_8
      func8d(i, j, 2) = 0.0_8
      func8dd(i, j, 3) = 0.0_8
      func8d(i, j, 3) = 0.0_8
      func8dd(i, j, 4) = 0.0_8
      func8d(i, j, 4) = 0.0_8
      func8dd(i, j, 5) = gradvdd(i, j, 2)
      func8d(i, j, 5) = gradvd(i, j, 2)
      func9dd(i, j, 1) = 0.0_8
      func9d(i, j, 1) = 0.0_8
      func9dd(i, j, 2) = 0.0_8
      func9d(i, j, 2) = 0.0_8
      func9dd(i, j, 3) = 0.0_8
      func9d(i, j, 3) = 0.0_8
      func9dd(i, j, 4) = 0.0_8
      func9d(i, j, 4) = 0.0_8
      func9dd(i, j, 5) = velxdd(i, j)
      func9d(i, j, 5) = velxd(i, j)
      func10dd(i, j, 1) = 0.0_8
      func10d(i, j, 1) = 0.0_8
      func10dd(i, j, 2) = 0.0_8
      func10d(i, j, 2) = 0.0_8
      func10dd(i, j, 3) = 0.0_8
      func10d(i, j, 3) = 0.0_8
      func10dd(i, j, 4) = 0.0_8
      func10d(i, j, 4) = 0.0_8
      func10dd(i, j, 5) = mud(i, j)*gradwd0(i, j, 1) + gradw(i, j, 1)*&
&       mudd(i, j) + gradwd(i, j, 1)*mud0(i, j) + mu(i, j)*gradwdd(i, j&
&       , 1)
      func10d(i, j, 5) = gradw(i, j, 1)*mud(i, j) + mu(i, j)*gradwd(i, j&
&       , 1)
      func11dd(i, j, 1) = 0.0_8
      func11d(i, j, 1) = 0.0_8
      func11dd(i, j, 2) = 0.0_8
      func11d(i, j, 2) = 0.0_8
      func11dd(i, j, 3) = 0.0_8
      func11d(i, j, 3) = 0.0_8
      func11dd(i, j, 4) = 0.0_8
      func11d(i, j, 4) = 0.0_8
      func11dd(i, j, 5) = velydd(i, j)
      func11d(i, j, 5) = velyd(i, j)
      func12dd(i, j, 1) = 0.0_8
      func12d(i, j, 1) = 0.0_8
      func12dd(i, j, 2) = 0.0_8
      func12d(i, j, 2) = 0.0_8
      func12dd(i, j, 3) = 0.0_8
      func12d(i, j, 3) = 0.0_8
      func12dd(i, j, 4) = 0.0_8
      func12d(i, j, 4) = 0.0_8
      func12dd(i, j, 5) = mud(i, j)*gradwd0(i, j, 2) + gradw(i, j, 2)*&
&       mudd(i, j) + gradwd(i, j, 2)*mud0(i, j) + mu(i, j)*gradwdd(i, j&
&       , 2)
      func12d(i, j, 5) = gradw(i, j, 2)*mud(i, j) + mu(i, j)*gradwd(i, j&
&       , 2)
      func13dd(i, j, 1) = 0.0_8
      func13d(i, j, 1) = 0.0_8
      func13dd(i, j, 2) = 0.0_8
      func13d(i, j, 2) = 0.0_8
      func13dd(i, j, 3) = 0.0_8
      func13d(i, j, 3) = 0.0_8
      func13dd(i, j, 4) = 0.0_8
      func13d(i, j, 4) = 0.0_8
      func13dd(i, j, 5) = velzdd(i, j)
      func13d(i, j, 5) = velzd(i, j)
      func14dd(i, j, 1) = 0.0_8
      func14d(i, j, 1) = 0.0_8
      func14dd(i, j, 2) = 0.0_8
      func14d(i, j, 2) = 0.0_8
      func14dd(i, j, 3) = 0.0_8
      func14d(i, j, 3) = 0.0_8
      func14dd(i, j, 4) = 0.0_8
      func14d(i, j, 4) = 0.0_8
!ZERO !mu(i,j)
      func14dd(i, j, 5) = mudd(i, j)
      func14d(i, j, 5) = mud(i, j)
      func15dd(i, j, 1) = 0.0_8
      func15d(i, j, 1) = 0.0_8
      func15dd(i, j, 2) = 0.0_8
      func15d(i, j, 2) = 0.0_8
      func15dd(i, j, 3) = 0.0_8
      func15d(i, j, 3) = 0.0_8
      func15dd(i, j, 4) = 0.0_8
      func15d(i, j, 4) = 0.0_8
      func15dd(i, j, 5) = gradudd(i, j, 1) + gradvdd(i, j, 2)
      func15d(i, j, 5) = gradud(i, j, 1) + gradvd(i, j, 2)
    END DO
  END DO
END SUBROUTINE FUNCTION_5P_DZ_D_D

